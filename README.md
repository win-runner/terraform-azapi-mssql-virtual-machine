<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | ~> 1.6 |
| <a name="requirement_azapi"></a> [azapi](#requirement\_azapi) | ~> 2.2 |
| <a name="requirement_time"></a> [time](#requirement\_time) | ~> 0.12 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_azapi"></a> [azapi](#provider\_azapi) | ~> 2.2 |
| <a name="provider_time"></a> [time](#provider\_time) | ~> 0.12 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_name"></a> [name](#input\_name) | The resource name | `string` | n/a | yes |
| <a name="input_location"></a> [location](#input\_location) | Resource location. | `string` | n/a | yes |
| <a name="input_type"></a> [type](#input\_type) | The resource type. | `string` | n/a | yes |
| <a name="input_parent_id"></a> [parent\_id](#input\_parent\_id) | The ID of the azure resource in which this resource is created. | `string` | n/a | yes |
| <a name="input_tags"></a> [tags](#input\_tags) | Resource tags. | `map(string)` | `null` | no |
| <a name="input_sqlBestPracticesAssessmentEnabled"></a> [sqlBestPracticesAssessmentEnabled](#input\_sqlBestPracticesAssessmentEnabled) | n/a | `bool` | `false` | no |
| <a name="input_logAnalyticsWorkspaceSettings"></a> [logAnalyticsWorkspaceSettings](#input\_logAnalyticsWorkspaceSettings) | - `defaultDataCollectionRuleResourceId` - The resource ID of the default Data Collection Rule to use for this workspace.<br/>- `forceCmkForQuery` - Indicates whether customer managed storage is mandatory for query management.<br/>- `publicNetworkAccessForIngestion` - The network access type for accessing Log Analytics ingestion.<br/>- `publicNetworkAccessForQuery` - The network access type for accessing Log Analytics query.<br/>- `retentionInDays` - The workspace data retention in days. Allowed values are per pricing plan.<br/><br/>---<br/>`features` block supports the following:<br/>- `clusterResourceId` - Dedicated LA cluster resourceId that is linked to the workspaces.<br/>- `disableLocalAuth` - Disable Non-AAD based Auth.<br/>- `enableDataExport` - Flag that indicate if data should be exported.<br/>- `enableLogAccessUsingOnlyResourcePermissions` - Flag that indicate which permission to use - resource or workspace or both.<br/>- `immediatePurgeDataOn30Days` - Flag that describes if we want to remove the data after 30 days.<br/><br/>---<br/>`sku` block supports the following:<br/>- `capacityReservationLevel` - The capacity reservation level in GB for this workspace, when CapacityReservation sku is selected.<br/>- `name` - The name of the SKU. Defaults to `PerGB2018`.<br/><br/>---<br/>`workspaceCapping` block supports the following:<br/>- `dailyQuotaGb` - The workspace daily quota for ingestion. | <pre>object({<br/>    defaultDataCollectionRuleResourceId = optional(string)<br/>    forceCmkForQuery                    = optional(bool)<br/>    publicNetworkAccessForIngestion     = optional(string)<br/>    publicNetworkAccessForQuery         = optional(string)<br/>    retentionInDays                     = optional(number)<br/>    features = optional(object({<br/>      clusterResourceId                           = optional(string)<br/>      disableLocalAuth                            = optional(bool)<br/>      enableDataExport                            = optional(bool)<br/>      enableLogAccessUsingOnlyResourcePermissions = optional(bool)<br/>      immediatePurgeDataOn30Days                  = optional(bool)<br/>    }))<br/>    sku = optional(object({<br/>      capacityReservationLevel = optional(number)<br/>      name                     = string<br/>    }))<br/>    workspaceCapping = optional(object({<br/>      dailyQuotaGb = optional(number)<br/>    }))<br/>  })</pre> | `{}` | no |
| <a name="input_tableSettings"></a> [tableSettings](#input\_tableSettings) | - `plan` - 	Instruct the system how to handle and charge the logs ingested to this table.<br/>- `retentionInDays` - The table retention in days, between 4 and 730. Setting this property to -1 will default to the workspace retention.<br/>- `totalRetentionInDays` - The table total retention in days, between 4 and 4383. Setting this property to -1 will default to table retention.<br/><br/>---<br/>`restoredLogs` block supports the following:<br/>- `endRestoreTime` - The timestamp to end the restore by (UTC).<br/>- `sourceTable` - The source table to restore from.<br/>- `startRestoreTime` - The timestamp to start the restore from (UTC).<br/><br/>---<br/>`schema` block supports the following:<br/>- `description` - The description of the table schema.<br/>- `displayName` - The display name of the table schema.<br/>- `name` - The name of the table schema.<br/><br/>---<br/>`columns` - A list of table custom columns.<br/>- dataTypeHint - Column data type logical hint.<br/>- description - Column description.<br/>- displayName - Column display name.<br/>- name - Column name.<br/>- type - Column data type.<br/><br/>---<br/>`searchResults` block supports the following:<br/>- `description` - Search job Description.<br/>- `endSearchTime` - The timestamp to end the search by (UTC)<br/>- `limit` - Limit the search job to return up to specified number of rows.<br/>- `query` - The query to run.<br/>- `startSearchTime` - The timestamp to start the search from (UTC). | <pre>map(object({<br/>    plan                 = optional(string)<br/>    retentionInDays      = optional(number)<br/>    totalRetentionInDays = optional(number)<br/>    restoredLogs = optional(object({<br/>      endRestoreTime   = optional(string)<br/>      sourceTable      = optional(string)<br/>      startRestoreTime = optional(string)<br/>    }))<br/>    schema = optional(object({<br/>      description = optional(string)<br/>      displayName = optional(string)<br/>      name        = optional(string)<br/>      columns = optional(list(object({<br/>        dataTypeHint = optional(string)<br/>        description  = optional(string)<br/>        displayName  = optional(string)<br/>        name         = string<br/>        type         = string<br/>      })))<br/>    }))<br/>    searchResults = optional(object({<br/>      description     = optional(string)<br/>      endSearchTime   = optional(string)<br/>      limit           = optional(number)<br/>      query           = optional(string)<br/>      startSearchTime = optional(string)<br/>    }))<br/>  }))</pre> | `{}` | no |
| <a name="input_dataCollectionEndpoint"></a> [dataCollectionEndpoint](#input\_dataCollectionEndpoint) | - `description` - The description of the data collection endpoint.<br/>- `immutableId` - The immutable ID of this data collection endpoint resource. This property is READ-ONLY.<br/><br/>---<br/>- `networkAcls` block supports the following:<br/>  - `publicNetworkAccess` - The network access type for accessing Log Analytics ingestion. Allowed values are `Enabled` and `Disabled`. | <pre>object({<br/>    description = optional(string)<br/>    immutableId = optional(string)<br/>    networkAcls = optional(object({<br/>      publicNetworkAccess = optional(string)<br/>    }))<br/>  })</pre> | `{}` | no |
| <a name="input_mssqlVirtualMachineSettings"></a> [mssqlVirtualMachineSettings](#input\_mssqlVirtualMachineSettings) | - `enableAutomaticUpgrade` - Enable automatic upgrade of SQL IaaS extension Agent.<br/>- `leastPrivilegeMode` - SQL IaaS Agent least privilege mode.<br/>- `sqlImageOffer` - SQL image offer. Examples include SQL2016-WS2016, SQL2017-WS2016.<br/>- `sqlImageSku` - SQL Server edition type.<br/>- `sqlManagement` - SQL Server Management type. NOTE: This parameter is not used anymore. API will automatically detect the Sql Management, refrain from using it.<br/>- `sqlServerLicenseType` - SQL Server license type.<br/>- `sqlVirtualMachineGroupResourceId` - ARM resource id of the SQL virtual machine group this SQL virtual machine is or will be part of.<br/>- `virtualMachineResourceId` - ARM Resource id of underlying virtual machine created from SQL marketplace image.<br/>- `wsfcStaticIp` - Domain credentials for setting up Windows Server Failover Cluster for SQL availability group.<br/><br/>---<br/>`assessmentSettings` block supports the following:<br/>- `enable` - Enable or disable SQL best practices Assessment feature on SQL virtual machine.<br/>- `runImmediately` - Run SQL best practices Assessment immediately on SQL virtual machine.<br/><br/>---<br/>`schedule` block supports the following:<br/>- `dayOfWeek` - Day of the week to run assessment.<br/>- `enable` - Enable or disable schedule for SQL best practices Assessment feature on SQL virtual machine.<br/>- `monthlyOccurrence` - Occurrence of the DayOfWeek day within a month to schedule assessment. Takes values: 1,2,3,4 and -1. Use -1 for last DayOfWeek day of the month.<br/>- `startTime` - Time of the day in HH:mm format. Eg. 17:30.<br/>- `weeklyInterval` - Number of weeks to schedule between 2 assessment runs. Takes value from 1-6.<br/><br/>---<br/>`autoBackupSettings` block supports the following:<br/>- `backupScheduleType` - Backup schedule type.<br/>- `backupSystemDbs` - Include or exclude system databases from auto backup.<br/>- `daysOfWeek` - Days of the week for the backups when FullBackupFrequency is set to Weekly.<br/>- `enable` - Enable or disable autobackup on SQL virtual machine.<br/>- `enableEncryption` - Enable or disable encryption for backup on SQL virtual machine.<br/>- `fullBackupFrequency` - Frequency of full backups. In both cases, full backups begin during the next scheduled time window.<br/>- `fullBackupStartTime` - Start time of a given day during which full backups can take place. 0-23 hours.<br/>- `fullBackupWindowHours` - Duration of the time window of a given day during which full backups can take place. 1-23 hours.<br/>- `logBackupFrequency` - Frequency of log backups. 5-60 minutes.<br/>- `password` - Password for encryption on backup.<br/>- `retentionPeriod` - Retention period of backup: 1-90 days.<br/>- `storageAccessKey` - Storage account key where backup will be taken to.<br/>- `storageAccountUrl` - Storage account url where backup will be taken to.<br/>- `storageContainerName` - Storage container name where backup will be taken to.<br/><br/>---<br/>`autoPatchingSettings` block supports the following:<br/>- `additionalVmPatch` - Additional Patch to be enable or enabled on the SQL Virtual Machine.<br/>- `dayOfWeek` - Day of week to apply the patch on.<br/>- `enable` - Enable or disable autopatching on SQL virtual machine.<br/>- `maintenanceWindowDuration` - Duration of patching.<br/>- `maintenanceWindowStartingHour` - Hour of the day when patching is initiated. Local VM time.<br/><br/>---<br/>`keyVaultCredentialSettings` block supports the following:<br/>- `azureKeyVaultUrl` - Azure Key Vault url.<br/>- `credentialName` - Credential name.<br/>- `enable` - Enable or disable key vault credential setting.<br/>- `servicePrincipalName` - Service principal name to access key vault.<br/>- `servicePrincipalSecret` - Service principal name secret to access key vault.<br/><br/>---<br/>`serverConfigurationsManagementSettings` block supports the following:<br/>- `additionalFeaturesServerConfigurations` - Additional SQL feature settings.<br/>- `azureAdAuthenticationSettings` - Azure AD authentication settings.<br/>- `sqlConnectivityUpdateSettings` - SQL connectivity type settings.<br/>- `sqlInstanceSettings` - SQL instance settings.<br/>- `sqlStorageUpdateSettings` - SQL storage update settings.<br/>- `sqlWorkloadTypeUpdateSettings` - SQL workload type update settings.<br/><br/>---<br/>`additionalFeaturesServerConfigurations` block supports the following:<br/>- `isRServicesEnabled` - Enable or disable R services on SQL virtual machine (SQL 2016 onwards).<br/><br/>---<br/>`azureAdAuthenticationSettings` block supports the following:<br/>- `clientId` - The client Id of the Managed Identity to query Microsoft Graph API. An empty string must be used for the system assigned Managed Identity.<br/><br/>---<br/>`sqlConnectivityUpdateSettings` block supports the following:<br/>- `connectivityType` - SQL Server connectivity option.<br/>- `port` - SQL Server port.<br/>- `sqlAuthUpdatePassword` - SQL Server sysadmin login password.<br/>- `sqlAuthUpdateUserName` - SQL Server sysadmin login to create.<br/><br/>---<br/>`sqlInstanceSettings` block supports the following:<br/>- `collation` - SQL Server Collation.<br/>- `isIfiEnabled` - SQL Server IFI.<br/>- `isLpimEnabled` - SQL Server LPIM.<br/>- `isOptimizeForAdHocWorkloadsEnabled` - SQL Server Optimize for AdHoc Workloads.<br/>- `maxDop` - SQL Server MaxDop.<br/>- `maxServerMemoryMB` - SQL Server Max Server Memory.<br/>- `minServerMemoryMB` - SQL Server Min Server Memory.<br/><br/>---<br/>`sqlStorageUpdateSettings` block supports the following:<br/>- `diskConfigurationType` - Disk configuration to apply to SQL Server.<br/>- `diskCount` - Virtual machine disk count.<br/>- `startingDeviceId` - Device id of the first disk to be updated.<br/><br/>---<br/>`sqlWorkloadTypeUpdateSettings` block supports the following:<br/>- `sqlWorkloadType` - SQL Server workload type.<br/><br/>---<br/>`storageConfigurationSettings` block supports the following:<br/>- `diskConfigurationType` - Disk configuration to apply to SQL Server.<br/>- `enableStorageConfigBlade` - Enable SQL IaaS Agent storage configuration blade in Azure Portal.<br/>- `sqlSystemDbOnDataDisk` - SQL Server SystemDb Storage on DataPool if true.<br/>- `storageWorkloadType` - Storage workload type.<br/><br/>---<br/>`sqlDataSettings` block supports the following:<br/>- `defaultFilePath` - SQL Server default file path.<br/>- `luns` - Logical Unit Numbers for the disks.<br/>- `useStoragePool` - Use storage pool to build a drive if true or not provided.<br/><br/>---<br/>`sqlLogSettings` block supports the following:<br/>- `defaultFilePath` - SQL Server default file path.<br/>- `luns` - Logical Unit Numbers for the disks.<br/>- `useStoragePool` - Use storage pool to build a drive if true or not provided.<br/><br/>---<br/>`sqlTempDbSettings` block supports the following:<br/>- `dataFileCount` - Number of data files for tempdb.<br/>- `dataFileSize` - Size of data file for tempdb.<br/>- `dataGrowth` - 	SQL Server tempdb data file autoGrowth size.<br/>- `defaultFilePath` - SQL Server default file path.<br/>- `logFileSize` - Size of log file for tempdb.<br/>- `logGrowth` - SQL Server tempdb log file autoGrowth size.<br/>- `luns` - Logical Unit Numbers for the disks.<br/>- `persistFolder` - Persist tempdb folder if true.<br/>- `persistFolderPath` - Persist tempdb folder path.<br/>- `useStoragePool` - Use storage pool to build a drive if true or not provided.<br/><br/>---<br/>`virtualMachineIdentitySettings` block supports the following:<br/>- `resourceId` - ARM Resource Id of the identity. Only required when UserAssigned identity is selected.<br/>- `type` - Identity type of the virtual machine. Specify None to opt-out of Managed Identities.<br/><br/>---<br/>`wsfcDomainCredentials` block supports the following:<br/>- `clusterBootstrapAccountPassword` - Cluster bootstrap account password.<br/>- `clusterOperatorAccountPassword` - Cluster operator account password.<br/>- `sqlServiceAccountPassword` - SQL service account password. | <pre>object({<br/>    enableAutomaticUpgrade           = optional(bool)<br/>    leastPrivilegeMode               = optional(string)<br/>    sqlImageOffer                    = optional(string)<br/>    sqlImageSku                      = optional(string)<br/>    sqlManagement                    = optional(string)<br/>    sqlServerLicenseType             = optional(string)<br/>    sqlVirtualMachineGroupResourceId = optional(string)<br/>    virtualMachineResourceId         = optional(string)<br/>    wsfcStaticIp                     = optional(string)<br/>    assessmentSettings = optional(object({<br/>      enable         = optional(bool)<br/>      runImmediately = optional(bool)<br/>      schedule = optional(object({<br/>        dayOfWeek         = optional(string)<br/>        enable            = optional(bool)<br/>        monthlyOccurrence = optional(number)<br/>        startTime         = optional(string)<br/>        weeklyInterval    = optional(number)<br/>      }))<br/>    }))<br/>    autoBackupSettings = optional(object({<br/>      backupScheduleType    = optional(string)<br/>      backupSystemDbs       = optional(bool)<br/>      daysOfWeek            = optional(list(string))<br/>      enable                = optional(bool)<br/>      enableEncryption      = optional(bool)<br/>      fullBackupFrequency   = optional(string)<br/>      fullBackupStartTime   = optional(number)<br/>      fullBackupWindowHours = optional(number)<br/>      logBackupFrequency    = optional(number)<br/>      password              = optional(string)<br/>      retentionPeriod       = optional(number)<br/>      storageAccessKey      = optional(string)<br/>      storageAccountUrl     = optional(string)<br/>      storageContainerName  = optional(string)<br/>    }))<br/>    autoPatchingSettings = optional(object({<br/>      additionalVmPatch             = optional(string)<br/>      dayOfWeek                     = optional(string)<br/>      enable                        = optional(bool)<br/>      maintenanceWindowDuration     = optional(number)<br/>      maintenanceWindowStartingHour = optional(number)<br/>    }))<br/>    keyVaultCredentialSettings = optional(object({<br/>      azureKeyVaultUrl       = optional(string)<br/>      credentialName         = optional(string)<br/>      enable                 = optional(bool)<br/>      servicePrincipalName   = optional(string)<br/>      servicePrincipalSecret = optional(string)<br/>    }))<br/>    serverConfigurationsManagementSettings = optional(object({<br/>      additionalFeaturesServerConfigurations = optional(object({<br/>        isRServicesEnabled = optional(bool)<br/>      }))<br/>      azureAdAuthenticationSettings = optional(object({<br/>        clientId = optional(string)<br/>      }))<br/>      sqlConnectivityUpdateSettings = optional(object({<br/>        connectivityType      = optional(string)<br/>        port                  = optional(number)<br/>        sqlAuthUpdatePassword = optional(string)<br/>        sqlAuthUpdateUserName = optional(string)<br/>      }))<br/>      sqlInstanceSettings = optional(object({<br/>        collation                          = optional(string)<br/>        isIfiEnabled                       = optional(bool)<br/>        isLpimEnabled                      = optional(bool)<br/>        isOptimizeForAdHocWorkloadsEnabled = optional(bool)<br/>        maxDop                             = optional(number)<br/>        maxServerMemoryMB                  = optional(number)<br/>        minServerMemoryMB                  = optional(number)<br/>      }))<br/>      sqlStorageUpdateSettings = optional(object({<br/>        diskConfigurationType = optional(string)<br/>        diskCount             = optional(number)<br/>        startingDeviceId      = optional(number)<br/>      }))<br/>      sqlWorkloadTypeUpdateSettings = optional(object({<br/>        sqlWorkloadType = optional(string)<br/>      }))<br/>    }))<br/>    storageConfigurationSettings = optional(object({<br/>      diskConfigurationType    = optional(string)<br/>      enableStorageConfigBlade = optional(bool)<br/>      sqlSystemDbOnDataDisk    = optional(bool)<br/>      storageWorkloadType      = optional(string)<br/>      sqlDataSettings = optional(object({<br/>        defaultFilePath = optional(string)<br/>        luns            = optional(list(number))<br/>        useStoragePool  = optional(bool)<br/>      }))<br/>      sqlLogSettings = optional(object({<br/>        defaultFilePath = optional(string)<br/>        luns            = optional(list(number))<br/>        useStoragePool  = optional(bool)<br/>      }))<br/>      sqlTempDbSettings = optional(object({<br/>        dataFileCount     = optional(number)<br/>        dataFileSize      = optional(number)<br/>        dataGrowth        = optional(number)<br/>        defaultFilePath   = optional(string)<br/>        logFileSize       = optional(number)<br/>        logGrowth         = optional(number)<br/>        luns              = optional(list(number))<br/>        persistFolder     = optional(bool)<br/>        persistFolderPath = optional(string)<br/>        useStoragePool    = optional(bool)<br/>      }))<br/>    }))<br/>    virtualMachineIdentitySettings = optional(object({<br/>      resourceId = optional(string)<br/>      type       = optional(string)<br/>    }))<br/>    wsfcDomainCredentials = optional(object({<br/>      clusterBootstrapAccountPassword = optional(string)<br/>      clusterOperatorAccountPassword  = optional(string)<br/>      sqlServiceAccountPassword       = optional(string)<br/>    }))<br/>  })</pre> | `{}` | no |
| <a name="input_update_settings"></a> [update\_settings](#input\_update\_settings) | `azureAdAuthenticationSettings` block supports the following:<br/>- `clientId` - The client Id of the Managed Identity to query Microsoft Graph API. An empty string must be used for the system assigned Managed Identity.<br/><br/>---<br/>`keyVaultCredentialSettings` block supports the following:<br/>- `enable` - Enable or disable key vault credential setting.<br/>- `azureKeyVaultUrl` - Azure Key Vault url.<br/>- `credentialName` - Credential name.<br/>- `servicePrincipalName` - Service principal name to access key vault.<br/>- `servicePrincipalSecret` - Service principal name secret to access key vault. | <pre>object({<br/>    serverConfigurationsManagementSettings = optional(object({<br/>      azureAdAuthenticationSettings = optional(object({<br/>        clientId = optional(string, "")<br/>      }))<br/>    }))<br/>    keyVaultCredentialSettings = optional(object({<br/>      enable                 = optional(bool)<br/>      azureKeyVaultUrl       = optional(string)<br/>      credentialName         = optional(string)<br/>      servicePrincipalName   = optional(string)<br/>      servicePrincipalSecret = optional(string)<br/>    }))<br/>  })</pre> | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_resource_id"></a> [resource\_id](#output\_resource\_id) | The ID of the SQL Virtual Machine. |
| <a name="output_resource_identity"></a> [resource\_identity](#output\_resource\_identity) | The identity of the SQL Virtual Machine. |
<!-- END_TF_DOCS -->